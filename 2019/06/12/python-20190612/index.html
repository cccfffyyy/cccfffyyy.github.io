
<!DOCTYPE html>
<html lang="zh-Hans" class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>python学习-Day12 - 碎片</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="cuify,"> 
    <meta name="description" content="To make each day count.,IO编程文件读写磁盘上读写文件的功能都是操作系统提供的，读写文件就是请求操作系统打开一个文件对象（文件描述符），然后通过操作系统提供的接口从这个文件对象中读取数据，或者把数据写入这个文件对象。  
,"> 
    <meta name="author" content="cuify"> 
    <link rel="alternative" href="atom.xml" title="碎片" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.ico"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">碎片</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="http://www.cphoenix.cn"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">python学习-Day12</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">python学习-Day12</h1>
        <div class="stuff">
            <span>六月 12, 2019</span>
            
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/IO编程/">IO编程</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/StringIO和BytesIO/">StringIO和BytesIO</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/json/">json</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/python/">python</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/序列化/">序列化</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/操作文件和目录/">操作文件和目录</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/文件读写/">文件读写</a></li></ul>


        </div>
        <div class="content markdown">
            <h3 id="IO编程"><a href="#IO编程" class="headerlink" title="IO编程"></a>IO编程</h3><h4 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h4><p>磁盘上读写文件的功能都是操作系统提供的，读写文件就是请求操作系统打开一个文件对象<br>（文件描述符），然后通过操作系统提供的接口从这个文件对象中读取数据，或者把数据写入这个文件对象。  </p>
<p><strong>读文件</strong><br>要以读文件的模式打开一个文件对象，使用Python内置的open()函数，传入文件名和标示符。<br>文件使用完毕后必须关闭，因为文件对象会占用操作系统的资源，并且操作系统同一时间能打开的文件数量也是有限的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读文件</span></span><br><span class="line"><span class="keyword">try</span>:       <span class="comment">#无论是否出错，都关闭文件</span></span><br><span class="line">    f = open(<span class="string">'./err.py'</span>,<span class="string">'r'</span>)   <span class="comment">#打开一个文件，r 代表读</span></span><br><span class="line">    print(f.read())     <span class="comment">#一次读取全部内容，读到内存，用str表示</span></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        f.close()   <span class="comment">#关闭文件</span></span><br></pre></td></tr></table></figure>
<pre><code>#err.py
import pdb

s = &#39;0&#39;
n = int(s)
pdb.set_trace() #运行到这里会自动暂停
print(10 / n)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更加简洁的写法，和try...finally一样</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./err.py'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:   <span class="comment">#with语句可以自动调用close方法</span></span><br><span class="line">    print(f.read(<span class="number">4</span>))   <span class="comment">#read(size)  最多读取size个字节的内容</span></span><br><span class="line">    print(f.readline()) <span class="comment">#每次读取一行内容</span></span><br><span class="line">    print(f.readlines())  <span class="comment">#一次读取所有内容并按行返回list，读取配置文件比较合适</span></span><br></pre></td></tr></table></figure>
<pre><code>#err
.py

[&#39;import pdb\n&#39;, &#39;\n&#39;, &quot;s = &#39;0&#39;\n&quot;, &#39;n = int(s)\n&#39;, &#39;pdb.set_trace() #运行到这里会自动暂停\n&#39;, &#39;print(10 / n)\n&#39;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    f = open(<span class="string">'./gbk.txt'</span>,<span class="string">'rb'</span>)  <span class="comment">#rb 二进制</span></span><br><span class="line">    print(f.read())</span><br><span class="line">    f2 = open(<span class="string">'./gbk.txt'</span>,<span class="string">'r'</span>,encoding = <span class="string">'utf-8'</span>, errors = <span class="string">'ignore'</span>) <span class="comment">#encoding 编码；errors 忽略编码错误</span></span><br><span class="line">    print(f2.read())</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    f.close()</span><br><span class="line">    f2.close()</span><br></pre></td></tr></table></figure>
<pre><code>b&#39;\xe6\xb5\x8b\xe8\xaf\x95\n&#39;
测试
</code></pre><p><strong>写文件</strong><br>写文件和读文件是一样的，唯一区别是调用open()函数时，传入标识符’w’或者’wb’表示写文本文件或写二进制文件。<br>以’w’模式写入文件时，如果文件已存在，会直接覆盖（相当于删掉后新写入一个文件）。如果我们希望追加到文件末尾怎么办？可以传入’a’以追加（append）模式写入。  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#写文件</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./gbk.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:  <span class="comment">#w完全覆盖</span></span><br><span class="line">    f.write(<span class="string">'写一行文本进去～'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./gbk.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    print(f.read())</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./gbk.txt'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> f:  <span class="comment">#追加 append</span></span><br><span class="line">    f.write(<span class="string">'追加文本～'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./gbk.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    print(f.read())</span><br></pre></td></tr></table></figure>
<pre><code>写一行文本进去～
写一行文本进去～追加文本～
</code></pre><p><strong>StringIO</strong><br>StringIO顾名思义就是在内存中读写str。要把str写入StringIO，我们需要先创建一个StringIO，然后，像文件一样写入即可  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#StringIO   </span></span><br><span class="line"><span class="comment">##BytesIO 和StringIO一样，只是操作的是二进制数据，不是str，在这里就不写了</span></span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line">f = StringIO()</span><br><span class="line">f.write(<span class="string">'hey '</span>)</span><br><span class="line">f.write(<span class="string">'buddy~'</span>)</span><br><span class="line">print(f.getvalue())   <span class="comment">#getvalue获取写入后的str</span></span><br><span class="line"></span><br><span class="line">t = StringIO(<span class="string">'今天\n天气\n真不错'</span>)   <span class="comment">#初始化一个str</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    s = t.readline()</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">''</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(s.strip())  <span class="comment">#strip用于移除字符串头尾指定的字符（默认为空格或换行符）或字符序列</span></span><br></pre></td></tr></table></figure>
<pre><code>hey buddy~
今天
天气
真不错
</code></pre><p><strong>BytesIO</strong><br>和StringIO一样，只是操作的是二进制数据   </p>
<h4 id="操作文件和目录"><a href="#操作文件和目录" class="headerlink" title="操作文件和目录"></a>操作文件和目录</h4><p>Python的os模块封装了操作系统的目录和文件操作，要注意这些函数有的在os模块中，有的在os.path模块中。</p>
<blockquote>
<h1 id="查看当前目录的绝对路径"><a href="#查看当前目录的绝对路径" class="headerlink" title="查看当前目录的绝对路径:"></a>查看当前目录的绝对路径:</h1><p>>&gt;&gt; os.path.abspath(‘.’)<br>‘/Users/michael’   </p>
<h1 id="在某个目录下创建一个新目录，首先把新目录的完整路径表示出来"><a href="#在某个目录下创建一个新目录，首先把新目录的完整路径表示出来" class="headerlink" title="在某个目录下创建一个新目录，首先把新目录的完整路径表示出来:"></a>在某个目录下创建一个新目录，首先把新目录的完整路径表示出来:</h1><p>>&gt;&gt; os.path.join(‘/Users/michael’, ‘testdir’)<br>‘/Users/michael/testdir’   </p>
<h1 id="然后创建一个目录"><a href="#然后创建一个目录" class="headerlink" title="然后创建一个目录:"></a>然后创建一个目录:</h1><p>>&gt;&gt; os.mkdir(‘/Users/michael/testdir’)   </p>
<h1 id="删掉一个目录"><a href="#删掉一个目录" class="headerlink" title="删掉一个目录:"></a>删掉一个目录:</h1><p>>&gt;&gt; os.rmdir(‘/Users/michael/testdir’)   </p>
<h1 id="拆分路径"><a href="#拆分路径" class="headerlink" title="拆分路径"></a>拆分路径</h1><p>>&gt;&gt;os.path.split(‘/Users/michael/testdir/file.txt’)<br>(‘/Users/michael/testdir’, ‘file.txt’)   </p>
<h1 id="得到文件扩展名"><a href="#得到文件扩展名" class="headerlink" title="得到文件扩展名"></a>得到文件扩展名</h1><p>>&gt;&gt; os.path.splitext(‘/path/to/file.txt’)<br>(‘/path/to/file’, ‘.txt’)   </p>
<h1 id="对文件重命名"><a href="#对文件重命名" class="headerlink" title="对文件重命名:"></a>对文件重命名:</h1><p>>&gt;&gt; os.rename(‘test.txt’, ‘test.py’)   </p>
<h1 id="删掉文件"><a href="#删掉文件" class="headerlink" title="删掉文件:"></a>删掉文件:</h1><p>>&gt;&gt; os.remove(‘test.py’)  </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#编写一个程序，能在当前目录以及当前目录的所有子目录下查找文件名包含指定字符串的文件，并打印出相对路径。</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printFileName</span><span class="params">(path, key_word)</span>:</span>   <span class="comment">#传入路径 和 关键字</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> os.listdir(path):</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(os.path.join(path, x)): </span><br><span class="line">            printFileName(os.path.join(path, x), key_word)</span><br><span class="line">        <span class="keyword">elif</span> key_word <span class="keyword">in</span> os.path.splitext(x)[<span class="number">0</span>]:</span><br><span class="line">              print(os.path.join(path, x))</span><br><span class="line">printFileName(<span class="string">'.'</span>,<span class="string">'0604'</span>)</span><br></pre></td></tr></table></figure>
<pre><code>./190604.ipynb
./.ipynb_checkpoints/190604-checkpoint.ipynb
</code></pre><h4 id="序列化-pickling-反序列化-unpickling"><a href="#序列化-pickling-反序列化-unpickling" class="headerlink" title="序列化(pickling) 反序列化(unpickling)"></a>序列化(pickling) 反序列化(unpickling)</h4><p>Python语言特定的序列化模块是pickle，但如果要把序列化搞得更通用、更符合Web标准，就可以使用json模块。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#序列化两种方式</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">d = dict(name = <span class="string">'Bob'</span>,age = <span class="number">20</span>, score = <span class="number">80</span>)</span><br><span class="line">f = open(<span class="string">'./dump.txt'</span>,<span class="string">'wb'</span>)</span><br><span class="line">pickle.dump(d,f)     <span class="comment">#序列化</span></span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./dump.txt'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = pickle.load(f)   <span class="comment">#反序列化</span></span><br><span class="line">    print(d)</span><br></pre></td></tr></table></figure>
<pre><code>{&#39;name&#39;: &#39;Bob&#39;, &#39;age&#39;: 20, &#39;score&#39;: 80}
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">d = dict(eat = <span class="string">'草莓'</span>,drink = <span class="string">'奶茶'</span>)</span><br><span class="line">b = pickle.dumps(d)  <span class="comment">#把任意对象序列化成一个bytes</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./dump.txt'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(b)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./dump.txt'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d = f.read()</span><br><span class="line">    d = pickle.loads(d)    <span class="comment">#反序列化</span></span><br><span class="line">    print(d)</span><br></pre></td></tr></table></figure>
<pre><code>{&#39;eat&#39;: &#39;草莓&#39;, &#39;drink&#39;: &#39;奶茶&#39;}
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python 内置 json</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">d = dict(name=<span class="string">'Bob'</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)</span><br><span class="line">print(json.dumps(d))   <span class="comment">#python 转化为 json</span></span><br><span class="line">json_str = <span class="string">'&#123;"age": 20, "score": 88, "name": "Bob"&#125;'</span></span><br><span class="line">print(json.loads(json_str))  <span class="comment">#json 反序列化为 python对象</span></span><br></pre></td></tr></table></figure>
<pre><code>{&quot;name&quot;: &quot;Bob&quot;, &quot;age&quot;: 20, &quot;score&quot;: 88}
{&#39;age&#39;: 20, &#39;score&#39;: 88, &#39;name&#39;: &#39;Bob&#39;}
</code></pre>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title="0" data-url="http://link.hhtjim.com/163/5146554.mp3"></li>
                    
                        <li title="1" data-url="http://link.hhtjim.com/qq/001faIUs4M2zna.mp3"></li>
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-ae="false" data-ci="f8871d20ac846f32d730" data-cs="7d11a8eb558c4d89d8e5306c0c0243e356ba16eb" data-r="cccfffyyy.github.io" data-o="cccfffyyy" data-a="cccfffyyy" data-d="true">查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
